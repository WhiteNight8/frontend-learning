# 异步编程方案

- 回调函数
  1. 可读性差
  2. 维护困难
  3. 错误处理复杂
- promise
- generator
- await async

## 解释什么是回调函数，异步编程中作用和缺点

回调函数时一种编程方式

- 函数式编程，函数可以作为一等公民传递给另一个函数
- 另一个函数在合适的时机调用传入的函数，被调用的函数即为回调函数



早期作用

- 网络请求，用户交互事件的回调，
- 不确定事件什么时候完成， 需要回调函数监听事件的完成，并且执行对应的操作



缺点

- 多个异步操作需要按照某种顺序执行时， 会产生回调地狱
- 嵌套的回调函数，导致代码可读性，维护性变差
- 回调函数的错误处理机制，比较麻烦



## 如何解决回调地狱

- 函数单独封装
- 使用库如aysnc
- promise





## 什么是Promise？引入Promise的原因是什么

promise时一种用于处理异步操作的JavaScript类，通过这个类创建出promise对象

- 当创建一个promise对象返回时， 相当于一个承诺，这个承诺会在之后的某个实践点兑现或者拒绝承诺
- 一个promise有三种状态，pending，fulfilled， rejected
- promise允许通过.then方法处理成功的结果，通过catch方法处理失败的结果
- 链式调用极大提高了异步代码的可读性和可维护性



在promise引入之前，JavaScript主要依赖回调函数来处理异步操作

- 复杂异步任务会导致回调地狱问题
- 难以维护跟阅读





## 什么是生成器，在异步编程中如何使用

生成器是JavaScript中的一种特殊的函数类型， function*

- 普通函数只有等到执行完毕或者return或者抛出异常才会终止
- 生成器函数可以控制函数的暂停和恢复执行
- 生成器函数每次调用这个迭代器的next方法时，生成器函数会从上次暂停的地方继续执行，直到遇到yield表达式或者函数结束

生成器函数的核心特点时可以暂停执行，并通过yield关键字将控制权还给调用者，同时还能保留当前的执行上下文



异步编程中，生成器可以用来简化复杂的异步逻辑， 在async，await之前，借助promise+ generator实现类似的功能

- 通过生成器函数来代替async的功能
- 通过yield代替await功能
- 



## 描述async和await，跟promise相比呢

aync await 是ES8引入的关键字， 目的是使异步代码处理起来更加的优雅，可以把异步代码像同步代码那样去编写， 提高代码的可读性和可维护性

async用于声明一个异步函数，本质是一个返回promise的函数

- 无论函数内部是否手动的返回一个promise对象，都会将返回值包装到一个promise来处理
- 如果返回值是promise，promise.resolve的状态由promise决定
- 如果返回值是一个对象并且实现了thenable，由对象的then方法决定
- 如果函数的内部发生了异常，会执行promise的reject操作





await只能在async函数内部使用， 用于等待一个promise的结果

- await后跟着一个表达式， 表达式返回一个promise
- await会等到promise的状态编程fulfilled状态，之后继续执行异步函数





**async/ await 与promise的优势跟不同**

- 编写方便： 处理多个异步操作时， 通过await实现同步代码的编写方式
- 代码的可读性和可维护性，避免了promise链式调用的嵌套





